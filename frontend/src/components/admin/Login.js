import React, { useState, useRef } from 'react'
import { useHistory } from "react-router-dom";
import { connect } from 'react-redux';
import Alerta from './Alerta';

const Login = (props) => {

    let history = useHistory();

    const [error, setError] = useState("")
    const [mensaje, setMensaje] = useState("")
    const user = useRef(null);
    const pass = useRef(null);

    const iniciarSesion = () => {

        let usuario = {
            user: user.current.value,
            pass: pass.current.value
        }

        fetch(`http://localhost:3001/iniciarsesion`, {
            method: "POST",
            body: JSON.stringify(usuario),
            headers: {
                'Content-Type': 'application/json'
            }
        }).then(r => r.json())
            .then(usuario => {
                console.log(usuario);

                if (usuario === null) {
                    setError(true)
                } else {
                    props.dispatch({ type: "SESION_INICIADA", payload: usuario })
                    history.push("/admin")
                }

            })
    }

    return (
        <div className="flex items-center h-screen bg-orange p-4">
            <div className="w-full md:w-96 mx-auto rounded-xl shadow-md p-8 bg-white">
                <svg xmlns="http://www.w3.org/2000/svg" className="w-1/4 mx-auto mb-8 w-auto" viewBox="0 0 120 115" fill="none">
                    <path d="M15.177 50.2314C18.5251 43.119 26.0544 39.315 33.4505 40.3722C35.1322 40.6125 36.8071 41.1043 38.4244 41.8656C42.2516 43.6672 45.1209 46.6795 46.7902 50.2303C48.9285 54.7786 49.098 60.2104 46.7902 65.1129" stroke="#F06F46" strokeWidth="10.7652" />
                    <path fillRule="evenodd" clipRule="evenodd" d="M25.841 68.6017C31.8765 71.4429 39.0725 68.8533 41.9136 62.8178L51.6537 67.4028C47.0173 77.2518 36.2494 82.249 26.0501 79.9828L23.9534 84.4369L27.713 86.2067C28.9811 86.8036 29.5252 88.3155 28.9282 89.5836L27.2562 93.1355C26.6593 94.4036 25.1474 94.9477 23.8793 94.3507L20.1198 92.581L16.3798 100.526C15.9022 101.54 14.6927 101.976 13.6782 101.498L8.35074 98.9903C7.33626 98.5127 6.901 97.3032 7.37855 96.2887L11.1185 88.3438L7.28614 86.5397C6.01804 85.9428 5.47395 84.4309 6.07089 83.1628L7.74287 79.6109C8.33981 78.3428 9.85172 77.7988 11.1198 78.3957L14.9522 80.1997L17.0371 75.7706C8.71552 69.3695 5.66191 57.8332 10.317 47.9442L20.0571 52.5292C17.2159 58.5647 19.8055 65.7606 25.841 68.6017Z" fill="#F06F46" />
                    <mask id="path-4-outside-1_113_3266" maskUnits="userSpaceOnUse" x="18.5872" y="0.200684" width="92" height="72" fill="black">
                        <rect fill="white" x="18.5872" y="0.200684" width="92" height="72" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M52.2221 16.8428C50.4924 16.5884 49.2964 14.9799 49.5509 13.2502L50.7783 4.90603C51.0327 3.17632 52.6412 1.98037 54.3709 2.23481C56.1006 2.48924 57.2966 4.09771 57.0421 5.82743L55.8147 14.1716C55.5603 15.9013 53.9518 17.0972 52.2221 16.8428ZM37.2687 15.5331C37.7691 17.2082 39.5328 18.1606 41.2079 17.6602C42.8831 17.1598 43.8355 15.3961 43.3351 13.7209L40.9211 5.63983C40.4207 3.96465 38.657 3.01231 36.9818 3.51272C35.3066 4.01313 34.3543 5.77679 34.8547 7.45197L37.2687 15.5331ZM58.6806 25.7991C58.4402 25.6908 58.1935 25.615 57.9452 25.5698C48.3723 22.2525 37.8333 25.6799 31.9876 33.7084C31.1228 34.885 30.3586 36.162 29.7132 37.533L29.7228 37.5375C24.3496 48.9522 29.2471 62.5615 40.6618 67.9348C52.0765 73.3081 65.6859 68.4106 71.0593 56.996L71.0664 56.9993C71.2915 56.5211 71.4986 56.0389 71.688 55.5537C71.7819 55.4208 71.874 55.2877 71.9644 55.1545L99.4995 58.5302C100.644 58.6705 101.774 58.1777 102.449 57.2438L107.32 51.8799C107.878 51.1089 108.059 50.1279 107.814 49.2085C107.569 48.289 106.923 47.5287 106.055 47.1379L58.6806 25.7991ZM61.3265 52.4142C64.1696 46.3741 61.5781 39.1729 55.538 36.3296C49.498 33.4864 42.2967 36.0778 39.4533 42.1178L39.4629 42.1222C36.6217 48.1577 39.2113 55.3537 45.2468 58.1948C51.2823 61.0359 58.4782 58.4464 61.3194 52.4109L61.3265 52.4142ZM32.1846 25.9204C30.9839 27.1913 28.9804 27.2482 27.7095 26.0476L21.5788 20.2557C20.308 19.055 20.251 17.0515 21.4517 15.7806C22.6523 14.5097 24.6559 14.4528 25.9267 15.6535L32.0574 21.4454C33.3283 22.646 33.3852 24.6496 32.1846 25.9204Z" />
                    </mask>
                    <path fillRule="evenodd" clipRule="evenodd" d="M52.2221 16.8428C50.4924 16.5884 49.2964 14.9799 49.5509 13.2502L50.7783 4.90603C51.0327 3.17632 52.6412 1.98037 54.3709 2.23481C56.1006 2.48924 57.2966 4.09771 57.0421 5.82743L55.8147 14.1716C55.5603 15.9013 53.9518 17.0972 52.2221 16.8428ZM37.2687 15.5331C37.7691 17.2082 39.5328 18.1606 41.2079 17.6602C42.8831 17.1598 43.8355 15.3961 43.3351 13.7209L40.9211 5.63983C40.4207 3.96465 38.657 3.01231 36.9818 3.51272C35.3066 4.01313 34.3543 5.77679 34.8547 7.45197L37.2687 15.5331ZM58.6806 25.7991C58.4402 25.6908 58.1935 25.615 57.9452 25.5698C48.3723 22.2525 37.8333 25.6799 31.9876 33.7084C31.1228 34.885 30.3586 36.162 29.7132 37.533L29.7228 37.5375C24.3496 48.9522 29.2471 62.5615 40.6618 67.9348C52.0765 73.3081 65.6859 68.4106 71.0593 56.996L71.0664 56.9993C71.2915 56.5211 71.4986 56.0389 71.688 55.5537C71.7819 55.4208 71.874 55.2877 71.9644 55.1545L99.4995 58.5302C100.644 58.6705 101.774 58.1777 102.449 57.2438L107.32 51.8799C107.878 51.1089 108.059 50.1279 107.814 49.2085C107.569 48.289 106.923 47.5287 106.055 47.1379L58.6806 25.7991ZM61.3265 52.4142C64.1696 46.3741 61.5781 39.1729 55.538 36.3296C49.498 33.4864 42.2967 36.0778 39.4533 42.1178L39.4629 42.1222C36.6217 48.1577 39.2113 55.3537 45.2468 58.1948C51.2823 61.0359 58.4782 58.4464 61.3194 52.4109L61.3265 52.4142ZM32.1846 25.9204C30.9839 27.1913 28.9804 27.2482 27.7095 26.0476L21.5788 20.2557C20.308 19.055 20.251 17.0515 21.4517 15.7806C22.6523 14.5097 24.6559 14.4528 25.9267 15.6535L32.0574 21.4454C33.3283 22.646 33.3852 24.6496 32.1846 25.9204Z" fill="#031030" />
                    <path d="M49.5509 13.2502L51.4254 13.5259L51.4254 13.5259L49.5509 13.2502ZM52.2221 16.8428L51.9464 18.7174L51.9464 18.7174L52.2221 16.8428ZM50.7783 4.90603L48.9037 4.63029L48.9037 4.63029L50.7783 4.90603ZM54.3709 2.23481L54.0952 4.10937L54.0952 4.10937L54.3709 2.23481ZM57.0421 5.82743L55.1676 5.55168L55.1676 5.55169L57.0421 5.82743ZM55.8147 14.1716L57.6893 14.4473L57.6893 14.4473L55.8147 14.1716ZM41.2079 17.6602L40.6656 15.8447L40.6656 15.8447L41.2079 17.6602ZM37.2687 15.5331L39.0841 14.9907L39.0841 14.9907L37.2687 15.5331ZM43.3351 13.7209L45.1505 13.1786L45.1505 13.1786L43.3351 13.7209ZM40.9211 5.63983L42.7365 5.09751L42.7365 5.09751L40.9211 5.63983ZM36.9818 3.51272L37.5241 5.32818L37.5241 5.32818L36.9818 3.51272ZM34.8547 7.45197L36.6702 6.90966L36.6702 6.90966L34.8547 7.45197ZM57.9452 25.5698L57.3248 27.3601L57.4625 27.4078L57.6059 27.4339L57.9452 25.5698ZM58.6806 25.7991L59.4588 24.0715L59.4588 24.0715L58.6806 25.7991ZM31.9876 33.7084L33.5143 34.8307L33.5193 34.8237L31.9876 33.7084ZM29.7132 37.533L27.9989 36.726L27.192 38.4403L28.9063 39.2473L29.7132 37.533ZM29.7228 37.5375L31.4371 38.3444L32.244 36.6301L30.5297 35.8232L29.7228 37.5375ZM71.0593 56.996L71.8662 55.2817L70.152 54.4748L69.345 56.189L71.0593 56.996ZM71.0664 56.9993L70.2594 58.7137L71.9737 59.5206L72.7807 57.8063L71.0664 56.9993ZM71.688 55.5537L70.1404 54.4606L70.007 54.6494L69.9229 54.8649L71.688 55.5537ZM71.9644 55.1545L72.1949 53.2738L71.0458 53.133L70.3961 54.0912L71.9644 55.1545ZM99.4995 58.5302L99.2689 60.4108L99.2689 60.4108L99.4995 58.5302ZM102.449 57.2438L101.047 55.97L100.976 56.0479L100.914 56.1331L102.449 57.2438ZM107.32 51.8799L108.723 53.1536L108.793 53.0757L108.855 52.9906L107.32 51.8799ZM106.055 47.1379L105.277 48.8654L105.277 48.8654L106.055 47.1379ZM61.3265 52.4142L60.5195 54.1285L62.2338 54.9355L63.0408 53.2211L61.3265 52.4142ZM55.538 36.3296L54.7311 38.0439L54.7311 38.0439L55.538 36.3296ZM39.4533 42.1178L37.7391 41.3108L36.932 43.0251L38.6464 43.8321L39.4533 42.1178ZM39.4629 42.1222L41.1771 42.9292L41.9841 41.2149L40.2698 40.4079L39.4629 42.1222ZM45.2468 58.1948L46.0538 56.4805L46.0538 56.4805L45.2468 58.1948ZM61.3194 52.4109L62.1263 50.6966L60.412 49.8896L59.6051 51.6039L61.3194 52.4109ZM27.7095 26.0476L29.0107 24.6703L29.0107 24.6703L27.7095 26.0476ZM32.1846 25.9204L30.8073 24.6192L30.8073 24.6192L32.1846 25.9204ZM21.5788 20.2557L20.2776 21.633L20.2777 21.633L21.5788 20.2557ZM21.4517 15.7806L20.0744 14.4794L20.0744 14.4794L21.4517 15.7806ZM25.9267 15.6535L27.2279 14.2762L27.2279 14.2762L25.9267 15.6535ZM32.0574 21.4454L30.7562 22.8227L30.7562 22.8227L32.0574 21.4454ZM47.6763 12.9744C47.2696 15.7394 49.1814 18.3106 51.9464 18.7174L52.4979 14.9682C51.8034 14.8661 51.3233 14.2204 51.4254 13.5259L47.6763 12.9744ZM48.9037 4.63029L47.6763 12.9744L51.4254 13.5259L52.6528 5.18178L48.9037 4.63029ZM54.6467 0.360245C51.8816 -0.046481 49.3105 1.86528 48.9037 4.63029L52.6528 5.18178C52.755 4.48735 53.4007 4.00722 54.0952 4.10937L54.6467 0.360245ZM58.9167 6.10318C59.3234 3.33817 57.4117 0.766969 54.6467 0.360244L54.0952 4.10937C54.7896 4.21152 55.2697 4.85726 55.1676 5.55168L58.9167 6.10318ZM57.6893 14.4473L58.9167 6.10317L55.1676 5.55169L53.9402 13.8958L57.6893 14.4473ZM51.9464 18.7174C54.7114 19.1241 57.2826 17.2123 57.6893 14.4473L53.9402 13.8958C53.838 14.5903 53.1923 15.0704 52.4979 14.9682L51.9464 18.7174ZM40.6656 15.8447C39.9931 16.0456 39.285 15.6633 39.0841 14.9907L35.4532 16.0754C36.2531 18.7532 39.0724 20.2756 41.7503 19.4756L40.6656 15.8447ZM41.5196 14.2632C41.7205 14.9358 41.3382 15.6438 40.6656 15.8447L41.7503 19.4756C44.4281 18.6757 45.9504 15.8564 45.1505 13.1786L41.5196 14.2632ZM39.1056 6.18214L41.5196 14.2632L45.1505 13.1786L42.7365 5.09751L39.1056 6.18214ZM37.5241 5.32818C38.1967 5.12728 38.9047 5.50961 39.1056 6.18214L42.7365 5.09751C41.9366 2.41968 39.1173 0.897328 36.4395 1.69725L37.5241 5.32818ZM36.6702 6.90966C36.4693 6.23713 36.8516 5.52908 37.5241 5.32818L36.4395 1.69725C33.7617 2.49718 32.2393 5.31646 33.0392 7.99429L36.6702 6.90966ZM39.0841 14.9907L36.6702 6.90966L33.0392 7.99429L35.4532 16.0754L39.0841 14.9907ZM57.6059 27.4339C57.7041 27.4517 57.8034 27.482 57.9025 27.5266L59.4588 24.0715C59.0771 23.8996 58.6829 23.7782 58.2846 23.7057L57.6059 27.4339ZM33.5193 34.8237C38.8798 27.4616 48.5485 24.3188 57.3248 27.3601L58.5656 23.7795C48.1962 20.1862 36.7869 23.8982 30.4559 32.5932L33.5193 34.8237ZM31.4275 38.34C32.0204 37.0805 32.7216 35.9089 33.5142 34.8306L30.4609 32.5862C29.5239 33.861 28.6968 35.2435 27.9989 36.726L31.4275 38.34ZM30.5297 35.8232L30.5202 35.8187L28.9063 39.2473L28.9158 39.2518L30.5297 35.8232ZM28.0085 36.7305C22.1896 49.092 27.4934 63.8301 39.8549 69.6491L41.4688 66.2205C31.0009 61.2929 26.5095 48.8124 31.4371 38.3444L28.0085 36.7305ZM39.8549 69.6491C52.2163 75.4681 66.9545 70.1644 72.7736 57.803L69.345 56.189C64.4173 66.6569 51.9367 71.1481 41.4688 66.2205L39.8549 69.6491ZM71.8733 55.285L71.8662 55.2817L70.2523 58.7103L70.2594 58.7137L71.8733 55.285ZM69.9229 54.8649C69.7491 55.3102 69.559 55.7529 69.3521 56.1924L72.7807 57.8063C73.0241 57.2892 73.2481 56.7677 73.4531 56.2426L69.9229 54.8649ZM70.3961 54.0912C70.3127 54.2143 70.2274 54.3374 70.1404 54.4606L73.2356 56.6469C73.3364 56.5042 73.4354 56.3611 73.5326 56.2178L70.3961 54.0912ZM99.7301 56.6495L72.1949 53.2738L71.7338 57.0351L99.2689 60.4108L99.7301 56.6495ZM100.914 56.1331C100.643 56.508 100.189 56.7058 99.7301 56.6495L99.2689 60.4108C101.098 60.6351 102.904 59.8473 103.984 58.3544L100.914 56.1331ZM105.917 50.6062L101.047 55.97L103.852 58.5175L108.723 53.1536L105.917 50.6062ZM105.983 49.6967C106.082 50.0659 106.009 50.4597 105.785 50.7692L108.855 52.9906C109.747 51.7582 110.037 50.19 109.645 48.7203L105.983 49.6967ZM105.277 48.8654C105.626 49.0223 105.885 49.3276 105.983 49.6967L109.645 48.7203C109.253 47.2505 108.22 46.035 106.833 45.4103L105.277 48.8654ZM57.9025 27.5266L105.277 48.8654L106.833 45.4103L59.4588 24.0715L57.9025 27.5266ZM63.0408 53.2211C66.3296 46.2343 63.3318 37.9042 56.345 34.6153L54.7311 38.0439C59.8243 40.4415 62.0096 46.514 59.6122 51.6072L63.0408 53.2211ZM56.345 34.6153C49.3582 31.3264 41.0281 34.324 37.7391 41.3108L41.1676 42.9248C43.5653 37.8316 49.6378 35.6463 54.7311 38.0439L56.345 34.6153ZM40.2698 40.4079L40.2603 40.4035L38.6464 43.8321L38.6559 43.8365L40.2698 40.4079ZM46.0538 56.4805C40.965 54.0851 38.7817 48.0179 41.1771 42.9292L37.7486 41.3153C34.4618 48.2975 37.4575 56.6223 44.4398 59.9091L46.0538 56.4805ZM59.6051 51.6039C57.2096 56.6926 51.1425 58.876 46.0538 56.4805L44.4398 59.9091C51.4221 63.1959 59.7468 60.2001 63.0337 53.2178L59.6051 51.6039ZM62.1334 50.6999L62.1263 50.6966L60.5124 54.1252L60.5195 54.1285L62.1334 50.6999ZM26.4083 27.4249C28.4398 29.3441 31.6426 29.2531 33.5619 27.2216L30.8073 24.6192C30.3253 25.1294 29.5209 25.1523 29.0107 24.6703L26.4083 27.4249ZM20.2777 21.633L26.4083 27.4249L29.0107 24.6703L22.88 18.8784L20.2777 21.633ZM20.0744 14.4794C18.1551 16.5109 18.2461 19.7137 20.2776 21.633L22.88 18.8784C22.3698 18.3964 22.347 17.592 22.829 17.0818L20.0744 14.4794ZM27.2279 14.2762C25.1964 12.3569 21.9937 12.4479 20.0744 14.4794L22.829 17.0818C23.311 16.5716 24.1153 16.5487 24.6256 17.0307L27.2279 14.2762ZM33.3586 20.0681L27.2279 14.2762L24.6256 17.0307L30.7562 22.8227L33.3586 20.0681ZM33.5619 27.2216C35.4811 25.1901 35.3901 21.9873 33.3586 20.0681L30.7562 22.8227C31.2664 23.3047 31.2893 24.109 30.8073 24.6192L33.5619 27.2216Z" fill="#FFFCFA" mask="url(#path-4-outside-1_113_3266)" />
                    <path d="M41.919 52.5204C40.7631 50.0615 38.7842 47.9841 36.1318 46.7356C35.0046 46.205 33.8462 45.8661 32.6888 45.7006C27.5669 44.9685 22.3601 47.6101 20.047 52.5239M51.6613 47.9403C49.4787 43.2975 45.719 39.3502 40.7168 36.9955C38.6095 36.0036 36.4181 35.359 34.212 35.0437C24.5418 33.6615 14.69 38.6278 10.307 47.939" stroke="#FFFCFA" strokeWidth="3.78947" />
                    <path fillRule="evenodd" clipRule="evenodd" d="M36.1323 46.7337C38.7847 47.9823 40.7635 50.0597 41.9195 52.5186L51.6618 47.9384C49.4792 43.2957 45.7195 39.3484 40.7173 36.9937C38.61 36.0017 36.4186 35.3572 34.2125 35.0419C24.5423 33.6597 14.6905 38.626 10.3075 47.9371L20.0475 52.5221C22.3606 47.6083 27.5674 44.9667 32.6893 45.6988C33.8467 45.8642 35.0051 46.2031 36.1323 46.7337Z" fill="#F06F46" />
                </svg>
                <div className="mb-6 col-span-1">
                    <div className="relative border border-black rounded-md px-3 py-2 shadow-sm  ">
                        <label htmlFor="nombre" className="absolute -top-2 left-2 bg-white -mt-px inline-block px-1  text-xs font-medium text-black">Nombre de usuario</label>
                        <input ref={user} required type="text" name="nombre" id="nombre" className="block w-full border-0 p-0 text-black placeholder-black placeholder-opacity-50 focus:ring-0 ring-opacity-0 focus:outline-none sm:text-sm" />
                    </div>
                </div>
                <div className="mb-6 col-span-1">
                    <div className="relative border border-black rounded-md px-3 py-2 shadow-sm  ">
                        <label htmlFor="password" className="absolute -top-2 left-2 bg-white -mt-px inline-block px-1  text-xs font-medium text-black">Contraseña</label>
                        <input ref={pass} required type="password" name="password" id="password" className="block w-full border-0 p-0 text-black placeholder-black placeholder-opacity-50 focus:ring-0 ring-opacity-0 focus:outline-none sm:text-sm" />
                    </div>
                </div>

                <button className="bg-orange py-3 px-8 rounded-3xl text-white text-base w-full" onClick={iniciarSesion}>Iniciar Sesión</button>
                <p className="font-body mt-4 text-sm text-center">¿No tenes una cuenta? Registrate acá</p>


            </div>


        </div>
    )
}

const mapStateToProps = (state) => ({
    usuarioLogueado: state.usuarioLogueado
})

export default connect(mapStateToProps)(Login)
